buildscript {
  ext {
    testrunnerVersion = '0.0.3'
  }
  repositories {
    mavenLocal() // (1) local
    jcenter()
    maven { url 'https://plugins.gradle.org/m2/' }
    maven { url 'http://smartbearsoftware.com/repository/maven2/' }
  }
  dependencies {
    // classpath "gradle.plugin.io.github.daggerok:soapui-testrunner:$testrunnerVersion"
    classpath "io.github.daggerok:soapui-testrunner:$testrunnerVersion" // (2) local
  }
}

plugins {
  id 'java'
}

apply plugin: io.github.daggerok.SoapUITestRunnerPlugin

group 'daggerok'
version '0.0.1'

// customize TestCases to run

import io.github.daggerok.tasks.SoapUITestRunnerTask

Task[] soapUITestCaseTasks = [

    'TestCase 1',
    'TestCase 2',
    'TestCase 3',
    'TestCase 4',
    'TestCase 5',

].collect { testCaseName ->

  def noSpaceCase = testCaseName.replaceAll(/\s+$/, '').capitalize()
  def task = tasks.create(name: noSpaceCase, type: SoapUITestRunnerTask) {
    testCase = noSpaceCase
    outputFolder = "$buildDir/soapui/$noSpaceCase"
    projectProperties = [
        'apiEndpoint=https://jsonplaceholder.typicode.com'
    ]
  }
  task
}

task soapUITestCases(dependsOn: soapUITestCaseTasks)

// customize TestSuites to run

Task[] soapUITestSuiteTasks = []

[
    'TestSuite 2',
    'TestSuite 3',

].each { testSuiteName ->

  def noSpaceSuite = testSuiteName.replaceAll(/\s+$/, '').capitalize()
  soapUITestSuiteTasks += tasks.create(name: noSpaceSuite, type: SoapUITestRunnerTask) {
    testSuite = testSuiteName
    outputFolder = "$buildDir/soapui/$noSpaceSuite"
    projectProperties = [
        'apiEndpoint=https://jsonplaceholder.typicode.com'
    ]
  }
}

task soapUITestSuites(dependsOn: soapUITestSuiteTasks)
